/*! For license information please see main.js.LICENSE.txt */
!function(){"use strict";var e={d:function(t,r){for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var t;e.g.importScripts&&(t=e.g.location+"");var r=e.g.document;if(!t&&r&&(r.currentScript&&(t=r.currentScript.src),!t)){var n=r.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t}(),e.d({},{X:function(){return Xe},H:function(){return Ve}});var t={P:{name:"pawn",color:"white",mg_values:[[0,0,0,0,0,0,0,0,98,134,61,95,68,126,34,-11,-6,7,26,31,65,56,25,-20,-14,13,6,21,23,12,17,-23,-27,-2,-5,12,17,6,10,-25,-26,-4,-4,-10,3,3,33,-12,-35,-1,-20,-23,-15,24,38,-22,0,0,0,0,0,0,0,0],82],eg_values:[[0,0,0,0,0,0,0,0,178,173,158,134,147,132,165,187,94,100,85,67,56,53,82,84,32,24,13,5,-2,4,17,17,13,9,-3,-7,-7,-8,3,-1,4,7,-6,1,0,-5,-1,-8,13,8,8,10,13,0,2,-7,0,0,0,0,0,0,0,0],94],moves:[[-1,0]],captures:[[-1,-1],[-1,1]],promotes:["queen","rook","bishop","knight"],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wp.png"},R:{name:"rook",color:"white",mg_values:[[32,42,32,51,63,9,31,43,27,32,58,62,80,67,26,44,-5,19,26,36,17,45,61,16,-24,-11,7,26,24,35,-8,-20,-36,-26,-12,-1,9,-7,6,-23,-45,-25,-16,-17,3,0,-5,-33,-44,-16,-20,-9,-1,11,-6,-71,-19,-13,1,17,16,7,-37,-26],477],eg_values:[[13,10,18,15,12,12,8,5,11,13,13,11,-3,3,8,3,7,7,7,5,4,-3,-5,-3,4,3,13,1,2,1,-1,2,3,5,8,4,-5,-6,-8,-11,-4,0,-5,-1,-7,-12,-8,-16,-6,-6,0,2,-9,-9,-11,-3,-9,2,3,-1,-5,-13,4,-20],512],moves:[[-1,0],[1,0],[0,-1],[0,1]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wr.png"},N:{name:"knight",color:"white",mg_values:[[-167,-89,-34,-49,61,-97,-15,-107,-73,-41,72,36,23,62,7,-17,-47,60,37,65,84,129,73,44,-9,17,19,53,37,69,18,22,-13,4,16,13,28,19,21,-8,-23,-9,12,10,19,17,25,-16,-29,-53,-12,-3,-1,18,-14,-19,-105,-21,-58,-33,-17,-28,-19,-23],337],eg_values:[[-58,-38,-13,-28,-31,-27,-63,-99,-25,-8,-25,-2,-9,-25,-24,-52,-24,-20,10,9,-1,-9,-19,-41,-17,3,22,22,22,11,8,-18,-18,-6,16,25,16,17,4,-18,-23,-3,-1,15,10,-3,-20,-22,-42,-20,-10,-5,-2,-20,-23,-44,-29,-51,-23,-15,-22,-18,-50,-64],281],moves:[[1,2],[2,1],[-1,2],[-2,1],[-2,-1],[-1,-2],[1,-2],[2,-1]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wn.png"},B:{name:"bishop",color:"white",mg_values:[[-29,4,-82,-37,-25,-42,7,-8,-26,16,-18,-13,30,59,18,-47,-16,37,43,40,35,50,37,-2,-4,5,19,50,37,37,7,-2,-6,13,13,26,34,12,10,4,0,15,15,15,14,27,18,10,4,15,16,0,7,21,33,1,-33,-3,-14,-21,-13,-12,-39,-21],365],eg_values:[[-14,-21,-11,-8,-7,-9,-17,-24,-8,-4,7,-12,-3,-13,-4,-14,2,-8,0,-1,-2,6,0,4,-3,9,12,9,14,10,3,2,-6,3,13,19,7,10,-3,-9,-12,-3,8,10,13,3,-7,-15,-14,-18,-7,-1,4,-9,-15,-27,-23,-9,-23,-5,-9,-16,-5,-17],297],moves:[[-1,-1],[-1,1],[1,-1],[1,1]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wb.png"},Q:{name:"queen",color:"white",mg_values:[[-28,0,29,12,59,44,43,45,-24,-39,-5,1,-16,57,28,54,-13,-17,7,8,29,56,47,57,-27,-27,-16,-16,-1,17,-2,1,-9,-26,-9,-10,-2,-4,3,-3,-14,2,-11,-2,-5,2,14,5,-35,-8,11,2,8,15,-3,1,-1,-18,-9,10,-15,-25,-31,-50],1025],eg_values:[[-9,22,22,27,27,19,10,20,-17,20,32,41,58,25,30,0,-20,6,9,49,47,35,19,9,3,22,24,45,57,40,57,36,-18,28,19,47,31,34,39,23,-16,-27,15,6,9,17,10,5,-22,-23,-30,-16,-16,-23,-36,-32,-33,-28,-22,-43,-5,-32,-20,-41],936],moves:[[-1,-1],[-1,1],[1,-1],[1,1],[0,-1],[0,1],[-1,0],[1,0]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wq.png"},K:{name:"king",color:"white",mg_values:[[-65,23,16,-15,-56,-34,2,13,29,-1,-20,-7,-8,-4,-38,-29,-9,24,2,-16,-20,6,22,-22,-17,-20,-12,-27,-30,-25,-14,-36,-49,-1,-27,-39,-46,-44,-33,-51,-14,-14,-22,-46,-44,-30,-15,-27,1,7,-8,-64,-43,-16,9,8,-15,36,12,-54,8,-28,24,14],0],eg_values:[[-74,-35,-18,-18,-11,15,4,-17,-12,17,14,17,17,38,23,11,10,17,23,15,20,45,44,13,-8,22,24,27,26,33,26,3,-18,-4,21,24,27,23,9,-11,-19,-3,11,21,23,16,7,-9,-27,-11,4,13,14,4,-5,-17,-53,-34,-21,-11,-28,-14,-24,-43],0],moves:[[0,1],[0,-1],[1,0],[-1,0],[1,1],[-1,1],[1,-1],[-1,-1]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/wk.png"},p:{name:"pawn",color:"black",mg_values:[[0,0,0,0,0,0,0,0,-22,38,24,-15,-23,-20,-1,-35,-12,33,3,3,-10,-4,-4,-26,-25,10,6,17,12,-5,-2,-27,-23,17,12,23,21,6,13,-14,-20,25,56,65,31,26,7,-6,-11,34,126,68,95,61,134,98,0,0,0,0,0,0,0,0],82],eg_values:[[0,0,0,0,0,0,0,0,-7,2,0,13,10,8,8,13,-8,-1,-5,0,1,-6,7,4,-1,3,-8,-7,-7,-3,9,13,17,17,4,-2,5,13,24,32,84,82,53,56,67,85,100,94,187,165,132,147,134,158,173,178,0,0,0,0,0,0,0,0],94],moves:[[1,0]],captures:[[1,-1],[1,1]],promotes:["queen","rook","bishop","knight"],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bp.png"},r:{name:"rook",color:"black",mg_values:[[-26,-37,7,16,17,1,-13,-19,-71,-6,11,-1,-9,-20,-16,-44,-33,-5,0,3,-17,-16,-25,-45,-23,6,-7,9,-1,-12,-26,-36,-20,-8,35,24,26,7,-11,-24,16,61,45,17,36,26,19,-5,44,26,67,80,62,58,32,27,43,31,9,63,51,32,42,32],477],eg_values:[[-20,4,-13,-5,-1,3,2,-9,-3,-11,-9,-9,2,0,-6,-6,-16,-8,-12,-7,-1,-5,0,-4,-11,-8,-6,-5,4,8,5,3,2,-1,1,2,1,13,3,4,-3,-5,-3,4,5,7,7,7,3,8,3,-3,11,13,13,11,5,8,12,12,15,18,10,13],512],moves:[[0,1],[0,-1],[1,0],[-1,0]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/br.png"},n:{name:"knight",color:"black",mg_values:[[-23,-19,-28,-17,-33,-58,-21,-105,-19,-14,18,-1,-3,-12,-53,-29,-16,25,17,19,10,12,-9,-23,-8,21,19,28,13,16,4,-13,22,18,69,37,53,19,17,-9,44,73,129,84,65,37,60,-47,-17,7,62,23,36,72,-41,-73,-107,-15,-97,61,-49,-34,-89,-167],337],eg_values:[[-64,-50,-18,-22,-15,-23,-51,-29,-44,-23,-20,-2,-5,-10,-20,-42,-22,-20,-3,10,15,-1,-3,-23,-18,4,17,16,25,16,-6,-18,-18,8,11,22,22,22,3,-17,-41,-19,-9,-1,9,10,-20,-24,-52,-24,-25,-9,-2,-25,-8,-25,-99,-63,-27,-31,-28,-13,-38,-58],281],moves:[[1,2],[2,1],[-1,2],[-2,1],[-2,-1],[-1,-2],[1,-2],[2,-1]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bn.png"},b:{name:"bishop",color:"black",mg_values:[[-21,-39,-12,-13,-21,-14,-3,-33,1,33,21,7,0,16,15,4,10,18,27,14,15,15,15,0,4,10,12,34,26,13,13,-6,-2,7,37,37,50,19,5,-4,-2,37,50,35,40,43,37,-16,-47,18,59,30,-13,-18,16,-26,-8,7,-42,-25,-37,-82,4,-29],365],eg_values:[[-17,-5,-16,-9,-5,-23,-9,-23,-27,-15,-9,4,-1,-7,-18,-14,-15,-7,3,13,10,8,-3,-12,-9,-3,10,7,19,13,3,-6,2,3,10,14,9,12,9,-3,4,0,6,-2,-1,0,-8,2,-14,-4,-13,-3,-12,7,-4,-8,-24,-17,-9,-7,-8,-11,-21,-14],297],moves:[[1,1],[-1,-1],[-1,1],[1,-1]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bb.png"},q:{name:"queen",color:"black",mg_values:[[-50,-31,-25,-15,10,-9,-18,-1,1,-3,15,8,2,11,-8,-35,5,14,2,-5,-2,-11,2,-14,-3,3,-4,-2,-10,-9,-26,-9,1,-2,17,-1,-16,-16,-27,-27,57,47,56,29,8,7,-17,-13,54,28,57,-16,1,-5,-39,-24,45,43,44,59,12,29,0,-28],1025],eg_values:[[-41,-20,-32,-5,-43,-22,-28,-33,-32,-36,-23,-16,-16,-30,-23,-22,5,10,17,9,6,15,-27,-16,23,39,34,31,47,19,28,-18,36,57,40,57,45,24,22,3,9,19,35,47,49,9,6,-20,0,30,25,58,41,32,20,-17,20,10,19,27,27,22,22,-9],936],moves:[[1,1],[-1,-1],[-1,1],[1,-1],[0,1],[0,-1],[1,0],[-1,0]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bq.png"},k:{name:"king",color:"black",mg_values:[[14,24,-28,8,-54,12,36,-15,8,9,-16,-43,-64,-8,7,1,-27,-15,-30,-44,-46,-22,-14,-14,-51,-33,-44,-46,-39,-27,-1,-49,-36,-14,-25,-30,-27,-12,-20,-17,-22,22,6,-20,-16,2,24,-9,-29,-38,-4,-8,-7,-20,-1,29,13,2,-34,-56,-15,16,23,-65],0],eg_values:[[-43,-24,-14,-28,-11,-21,-34,-53,-17,-5,4,14,13,4,-11,-27,-9,7,16,23,21,11,-3,-19,-11,9,23,27,24,21,-4,-18,3,26,33,26,27,24,22,-8,13,44,45,20,15,23,17,10,11,23,38,17,17,14,17,-12,-17,4,15,-11,-18,-18,-35,-74],0],moves:[[0,1],[0,-1],[1,0],[-1,0],[1,1],[-1,1],[1,-1],[-1,-1]],captures:[],promotes:[],image:"https://images.chesscomfiles.com/chess-themes/pieces/neo/150/bk.png"}},r=function(){for(var e=[],t=0;t<8;t++){e[t]=[];for(var r=0;r<8;r++){var n=document.querySelector('[data-row="'.concat(t,'"][data-col="').concat(r,'"]')).getAttribute("data-type");e[t][r]=" "!==n?n:" "}}return e};const n="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",o=["1-0","0-1","1/2-1/2","*"],a={b:[16,32,17,15],w:[-16,-32,-17,-15]},i={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},u=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],c=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],l={p:0,n:1,b:2,r:3,q:4,k:5},s={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},f={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},p={w:[{square:f.a1,flag:s.QSIDE_CASTLE},{square:f.h1,flag:s.KSIDE_CASTLE}],b:[{square:f.a8,flag:s.QSIDE_CASTLE},{square:f.h8,flag:s.KSIDE_CASTLE}]};function h(e){var t=e.charAt(0);if(t>="a"&&t<="h"){if(e.match(/[a-h]\d.*[a-h]\d/))return;return L}return"o"===(t=t.toLowerCase())?_:t}function v(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function d(e){return e>>4}function m(e){return 15&e}function g(e){var t=m(e),r=d(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(r,r+1)}function b(e){return e===A?E:A}function y(e){var t=e instanceof Array?[]:{};for(var r in e)t[r]="object"==typeof r?y(e[r]):e[r];return t}function w(e){return e.replace(/^\s+|\s+$/g,"")}const E="b",A="w",N=-1,L="p",_="k",k=(function(){for(var e=[],t=f.a8;t<=f.h1;t++)136&t?t+=7:e.push(g(t))}(),{NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"}),C=function(e){var t=new Array(128),r={w:N,b:N},C=A,S={w:0,b:0},P=N,x=0,O=1,T=[],I={},q={};function j(e){void 0===e&&(e=!1),t=new Array(128),r={w:N,b:N},C=A,S={w:0,b:0},P=N,x=0,O=1,T=[],e||(I={}),q={},D(K())}function R(){for(var e=[],t={},r=function(e){e in q&&(t[e]=q[e])};T.length>0;)e.push(re());for(r(K());e.length>0;)te(e.pop()),r(K());q=t}function B(){M(n)}function M(e,t){void 0===t&&(t=!1);var r=e.split(/\s+/),n=r[0],o=0;if(!U(e).valid)return!1;j(t);for(var a=0;a<n.length;a++){var i=n.charAt(a);if("/"===i)o+=8;else if(-1!=="0123456789".indexOf(i))o+=parseInt(i,10);else{var u=i<"a"?A:E;F({type:i.toLowerCase(),color:u},g(o)),o++}}return C=r[1],r[2].indexOf("K")>-1&&(S.w|=s.KSIDE_CASTLE),r[2].indexOf("Q")>-1&&(S.w|=s.QSIDE_CASTLE),r[2].indexOf("k")>-1&&(S.b|=s.KSIDE_CASTLE),r[2].indexOf("q")>-1&&(S.b|=s.QSIDE_CASTLE),P="-"===r[3]?N:f[r[3]],x=parseInt(r[4],10),O=parseInt(r[5],10),D(K()),!0}function U(e){var t=e.split(/\s+/);if(6!==t.length)return{valid:!1,error_number:1,error:"FEN string must contain six space-delimited fields."};if(isNaN(parseInt(t[5]))||parseInt(t[5],10)<=0)return{valid:!1,error_number:2,error:"6th field (move number) must be a positive integer."};if(isNaN(parseInt(t[4]))||parseInt(t[4],10)<0)return{valid:!1,error_number:3,error:"5th field (half move counter) must be a non-negative integer."};if(!/^(-|[abcdefgh][36])$/.test(t[3]))return{valid:!1,error_number:4,error:"4th field (en-passant square) is invalid."};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(t[2]))return{valid:!1,error_number:5,error:"3rd field (castling availability) is invalid."};if(!/^(w|b)$/.test(t[1]))return{valid:!1,error_number:6,error:"2nd field (side to move) is invalid."};var r=t[0].split("/");if(8!==r.length)return{valid:!1,error_number:7,error:"1st field (piece positions) does not contain 8 '/'-delimited rows."};for(var n=0;n<r.length;n++){for(var o=0,a=!1,i=0;i<r[n].length;i++)if(isNaN(r[n][i])){if(!/^[prnbqkPRNBQK]$/.test(r[n][i]))return{valid:!1,error_number:9,error:"1st field (piece positions) is invalid [invalid piece]."};o+=1,a=!1}else{if(a)return{valid:!1,error_number:8,error:"1st field (piece positions) is invalid [consecutive numbers]."};o+=parseInt(r[n][i],10),a=!0}if(8!==o)return{valid:!1,error_number:10,error:"1st field (piece positions) is invalid [row too large]."}}return"3"==t[3][1]&&"w"==t[1]||"6"==t[3][1]&&"b"==t[1]?{valid:!1,error_number:11,error:"Illegal en-passant square"}:{valid:!0,error_number:0,error:"No errors."}}function K(){for(var e=0,r="",n=f.a8;n<=f.h1;n++){if(null==t[n])e++;else{e>0&&(r+=e,e=0);var o=t[n].color,a=t[n].type;r+=o===A?a.toUpperCase():a.toLowerCase()}n+1&136&&(e>0&&(r+=e),n!==f.h1&&(r+="/"),e=0,n+=8)}var i="";S[A]&s.KSIDE_CASTLE&&(i+="K"),S[A]&s.QSIDE_CASTLE&&(i+="Q"),S[E]&s.KSIDE_CASTLE&&(i+="k"),S[E]&s.QSIDE_CASTLE&&(i+="q"),i=i||"-";var u=P===N?"-":g(P);return[r,C,i,u,x,O].join(" ")}function Q(e){for(var t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(I[e[t]]=e[t+1]);return I}function D(e){T.length>0||(e!==n?(I.SetUp="1",I.FEN=e):(delete I.SetUp,delete I.FEN))}function G(e){var r=t[f[e]];return r?{type:r.type,color:r.color}:null}function F(e,n){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(n in f))return!1;var o=f[n];return(e.type!=_||r[e.color]==N||r[e.color]==o)&&(t[o]={type:e.type,color:e.color},e.type===_&&(r[e.color]=o),D(K()),!0)}function $(e,t,r,n,o){var a={color:C,from:t,to:r,flags:n,piece:e[t].type};return o&&(a.flags|=s.PROMOTION,a.promotion=o),e[r]?a.captured=e[r].type:n&s.EP_CAPTURE&&(a.captured=L),a}function H(e){function n(e,t,r,n,o){if(e[r].type!==L||0!==d(n)&&7!==d(n))t.push($(e,r,n,o));else for(var a=["q","r","b","n"],i=0,u=a.length;i<u;i++)t.push($(e,r,n,o,a[i]))}var o=[],u=C,c=b(u),l={b:1,w:6},p=f.a8,h=f.h1,v=!1,m=void 0===e||!("legal"in e)||e.legal,g=void 0===e||!("piece"in e)||"string"!=typeof e.piece||e.piece.toLowerCase();if(void 0!==e&&"square"in e){if(!(e.square in f))return[];p=h=f[e.square],v=!0}for(var y=p;y<=h;y++)if(136&y)y+=7;else{var w=t[y];if(null!=w&&w.color===u)if(w.type!==L||!0!==g&&g!==L){if(!0===g||g===w.type)for(var E=0,A=i[w.type].length;E<A;E++){var N=i[w.type][E];for(k=y;!(136&(k+=N));){if(null!=t[k]){if(t[k].color===u)break;n(t,o,y,k,s.CAPTURE);break}if(n(t,o,y,k,s.NORMAL),"n"===w.type||"k"===w.type)break}}}else{var k=y+a[u][0];if(null==t[k]){n(t,o,y,k,s.NORMAL);k=y+a[u][1];l[u]===d(y)&&null==t[k]&&n(t,o,y,k,s.BIG_PAWN)}for(E=2;E<4;E++)136&(k=y+a[u][E])||(null!=t[k]&&t[k].color===c?n(t,o,y,k,s.CAPTURE):k===P&&n(t,o,y,P,s.EP_CAPTURE))}}if(!(!0!==g&&g!==_||v&&h!==r[u])){if(S[u]&s.KSIDE_CASTLE){var x=(O=r[u])+2;null!=t[O+1]||null!=t[x]||Y(c,r[u])||Y(c,O+1)||Y(c,x)||n(t,o,r[u],x,s.KSIDE_CASTLE)}var O;if(S[u]&s.QSIDE_CASTLE)x=(O=r[u])-2,null!=t[O-1]||null!=t[O-2]||null!=t[O-3]||Y(c,r[u])||Y(c,O-1)||Y(c,x)||n(t,o,r[u],x,s.QSIDE_CASTLE)}if(!m)return o;var T=[];for(y=0,A=o.length;y<A;y++)te(o[y]),z(u)||T.push(o[y]),re();return T}function W(e,t){var r="";if(e.flags&s.KSIDE_CASTLE)r="O-O";else if(e.flags&s.QSIDE_CASTLE)r="O-O-O";else{if(e.piece!==L){var n=function(e,t){for(var r=e.from,n=e.to,o=e.piece,a=0,i=0,u=0,c=0,l=t.length;c<l;c++){var s=t[c].from,f=t[c].to;o===t[c].piece&&r!==s&&n===f&&(a++,d(r)===d(s)&&i++,m(r)===m(s)&&u++)}return a>0?i>0&&u>0?g(r):u>0?g(r).charAt(1):g(r).charAt(0):""}(e,t);r+=e.piece.toUpperCase()+n}e.flags&(s.CAPTURE|s.EP_CAPTURE)&&(e.piece===L&&(r+=g(e.from)[0]),r+="x"),r+=g(e.to),e.flags&s.PROMOTION&&(r+="="+e.promotion.toUpperCase())}return te(e),X()&&(Z()?r+="#":r+="+"),re(),r}function Y(e,r){for(var n=f.a8;n<=f.h1;n++)if(136&n)n+=7;else if(null!=t[n]&&t[n].color===e){var o=t[n],a=n-r,i=a+119;if(u[i]&1<<l[o.type]){if(o.type===L){if(a>0){if(o.color===A)return!0}else if(o.color===E)return!0;continue}if("n"===o.type||"k"===o.type)return!0;for(var s=c[i],p=n+s,h=!1;p!==r;){if(null!=t[p]){h=!0;break}p+=s}if(!h)return!0}}return!1}function z(e){return Y(b(e),r[e])}function X(){return z(C)}function Z(){return X()&&0===H().length}function J(){return!X()&&0===H().length}function V(){for(var e={},r=[],n=0,o=0,a=f.a8;a<=f.h1;a++)if(o=(o+1)%2,136&a)a+=7;else{var i=t[a];i&&(e[i.type]=i.type in e?e[i.type]+1:1,"b"===i.type&&r.push(o),n++)}if(2===n)return!0;if(3===n&&(1===e.b||1===e.n))return!0;if(n===e.b+2){var u=0,c=r.length;for(a=0;a<c;a++)u+=r[a];if(0===u||u===c)return!0}return!1}function ee(){for(var e=[],t={},r=!1;;){var n=re();if(!n)break;e.push(n)}for(;;){var o=K().split(" ").slice(0,4).join(" ");if(t[o]=o in t?t[o]+1:1,t[o]>=3&&(r=!0),!e.length)break;te(e.pop())}return r}function te(e){var n=C,o=b(n);if(function(e){T.push({move:e,kings:{b:r.b,w:r.w},turn:C,castling:{b:S.b,w:S.w},ep_square:P,half_moves:x,move_number:O})}(e),t[e.to]=t[e.from],t[e.from]=null,e.flags&s.EP_CAPTURE&&(C===E?t[e.to-16]=null:t[e.to+16]=null),e.flags&s.PROMOTION&&(t[e.to]={type:e.promotion,color:n}),t[e.to].type===_){if(r[t[e.to].color]=e.to,e.flags&s.KSIDE_CASTLE){var a=e.to-1,i=e.to+1;t[a]=t[i],t[i]=null}else e.flags&s.QSIDE_CASTLE&&(a=e.to+1,i=e.to-2,t[a]=t[i],t[i]=null);S[n]=""}if(S[n])for(var u=0,c=p[n].length;u<c;u++)if(e.from===p[n][u].square&&S[n]&p[n][u].flag){S[n]^=p[n][u].flag;break}if(S[o])for(u=0,c=p[o].length;u<c;u++)if(e.to===p[o][u].square&&S[o]&p[o][u].flag){S[o]^=p[o][u].flag;break}P=e.flags&s.BIG_PAWN?"b"===C?e.to-16:e.to+16:N,e.piece===L||e.flags&(s.CAPTURE|s.EP_CAPTURE)?x=0:x++,C===E&&O++,C=b(C)}function re(){var e=T.pop();if(null==e)return null;var n=e.move;r=e.kings,C=e.turn,S=e.castling,P=e.ep_square,x=e.half_moves,O=e.move_number;var o,a,i=C,u=b(C);if(t[n.from]=t[n.to],t[n.from].type=n.piece,t[n.to]=null,n.flags&s.CAPTURE)t[n.to]={type:n.captured,color:u};else if(n.flags&s.EP_CAPTURE){var c;c=i===E?n.to-16:n.to+16,t[c]={type:L,color:u}}return n.flags&(s.KSIDE_CASTLE|s.QSIDE_CASTLE)&&(n.flags&s.KSIDE_CASTLE?(o=n.to+1,a=n.to-1):n.flags&s.QSIDE_CASTLE&&(o=n.to-2,a=n.to+1),t[o]=t[a],t[a]=null),n}function ne(e,t){for(var r=v(e),n=0;n<2;n++){if(1==n){if(!t)return null;var o=!1;if(l=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/)){var a=l[1],i=l[2],u=l[3],c=l[4];1==i.length&&(o=!0)}else{var l;(l=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/))&&(a=l[1],i=l[2],u=l[3],c=l[4],1==i.length&&(o=!0))}}for(var s=h(r),p=H({legal:!0,piece:a||s}),d=0,m=p.length;d<m;d++)switch(n){case 0:if(r===v(W(p[d],p)))return p[d];break;case 1:if(l){if(!(a&&a.toLowerCase()!=p[d].piece||f[i]!=p[d].from||f[u]!=p[d].to||c&&c.toLowerCase()!=p[d].promotion))return p[d];if(o){var b=g(p[d].from);if(!(a&&a.toLowerCase()!=p[d].piece||f[u]!=p[d].to||i!=b[0]&&i!=b[1]||c&&c.toLowerCase()!=p[d].promotion))return p[d]}}}}return null}function oe(e){var t=y(e);t.san=W(t,H({legal:!0})),t.to=g(t.to),t.from=g(t.from);var r="";for(var n in s)s[n]&t.flags&&(r+=k[n]);return t.flags=r,t}function ae(e){for(var t=H({legal:!1}),r=0,n=C,o=0,a=t.length;o<a;o++)te(t[o]),z(n)||(e-1>0?r+=ae(e-1):r++),re();return r}return M(void 0===e?n:e),{load:function(e){return M(e)},reset:function(){return B()},moves:function(e){for(var t=H(e),r=[],n=0,o=t.length;n<o;n++)void 0!==e&&"verbose"in e&&e.verbose?r.push(oe(t[n])):r.push(W(t[n],H({legal:!0})));return r},in_check:function(){return X()},in_checkmate:function(){return Z()},in_stalemate:function(){return J()},in_draw:function(){return x>=100||J()||V()||ee()},insufficient_material:function(){return V()},in_threefold_repetition:function(){return ee()},game_over:function(){return x>=100||Z()||J()||V()||ee()},validate_fen:function(e){return U(e)},fen:function(){return K()},board:function(){for(var e=[],r=[],n=f.a8;n<=f.h1;n++)null==t[n]?r.push(null):r.push({square:g(n),type:t[n].type,color:t[n].color}),n+1&136&&(e.push(r),r=[],n+=8);return e},pgn:function(e){var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",r="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,n=[],o=!1;for(var a in I)n.push("["+a+' "'+I[a]+'"]'+t),o=!0;o&&T.length&&n.push(t);for(var i=function(e){var t=q[K()];return void 0!==t&&(e=`${e}${e.length>0?" ":""}{${t}}`),e},u=[];T.length>0;)u.push(re());var c=[],l="";for(0===u.length&&c.push(i(""));u.length>0;){l=i(l);var s=u.pop();T.length||"b"!==s.color?"w"===s.color&&(l.length&&c.push(l),l=O+"."):l=O+". ...",l=l+" "+W(s,H({legal:!0})),te(s)}if(l.length&&c.push(i(l)),void 0!==I.Result&&c.push(I.Result),0===r)return n.join("")+c.join(" ");var f=function(){return n.length>0&&" "===n[n.length-1]&&(n.pop(),!0)},p=function(e,o){for(var a of o.split(" "))if(a){if(e+a.length>r){for(;f();)e--;n.push(t),e=0}n.push(a),e+=a.length,n.push(" "),e++}return f()&&e--,e},h=0;for(a=0;a<c.length;a++)h+c[a].length>r&&c[a].includes("{")?h=p(h,c[a]):(h+c[a].length>r&&0!==a?(" "===n[n.length-1]&&n.pop(),n.push(t),h=0):0!==a&&(n.push(" "),h++),n.push(c[a]),h+=c[a].length);return n.join("")},load_pgn:function(e,t){var r=void 0!==t&&"sloppy"in t&&t.sloppy;function n(e){return e.replace(/\\/g,"\\")}e=e.trim();var a="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",i=new RegExp("^(\\[((?:"+n(a)+")|.)*\\])(?:\\s*"+n(a)+"){2}"),u=i.test(e)?i.exec(e)[1]:"";B();var c=function(e,t){for(var r="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",o={},a=e.split(new RegExp(n(r))),i="",u="",c=0;c<a.length;c++){var l=/^\s*\[([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;i=a[c].replace(l,"$1"),u=a[c].replace(l,"$2"),w(i).length>0&&(o[i]=u)}return o}(u,t),l="";for(var s in c)"fen"===s.toLowerCase()&&(l=c[s]),Q([s,c[s]]);if(r){if(l&&!M(l,!0))return!1}else if(!("1"!==c.SetUp||"FEN"in c&&M(c.FEN,!0)))return!1;for(var f=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(n(a),"g")," ")).slice(1,e.length-1))}}`},p=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+e.match(/.{1,2}/g).join("%"))}(e.slice(1,e.length-1))},h=e.replace(u,"").replace(new RegExp(`({[^}]*})+?|;([^${n(a)}]*)`,"g"),(function(e,t,r){return void 0!==t?f(t):" "+f(`{${r.slice(1)}}`)})).replace(new RegExp(n(a),"g")," "),v=/(\([^\(\)]+\))+?/g;v.test(h);)h=h.replace(v,"");var d=w(h=(h=(h=h.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));d=d.join(",").replace(/,,+/g,",").split(",");for(var m="",g="",b=0;b<d.length;b++){var y=p(d[b]);if(void 0===y)if(null==(m=ne(d[b],r))){if(!(o.indexOf(d[b])>-1))return!1;g=d[b]}else g="",te(m);else q[K()]=y}return g&&Object.keys(I).length&&!I.Result&&Q(["Result",g]),!0},header:function(){return Q(arguments)},turn:function(){return C},move:function(e,t){var r=void 0!==t&&"sloppy"in t&&t.sloppy,n=null;if("string"==typeof e)n=ne(e,r);else if("object"==typeof e)for(var o=H(),a=0,i=o.length;a<i;a++)if(e.from===g(o[a].from)&&e.to===g(o[a].to)&&(!("promotion"in o[a])||e.promotion===o[a].promotion)){n=o[a];break}if(!n)return null;var u=oe(n);return te(n),u},undo:function(){var e=re();return e?oe(e):null},clear:function(){return j()},put:function(e,t){return F(e,t)},get:function(e){return G(e)},ascii(){for(var e="   +------------------------+\n",r=f.a8;r<=f.h1;r++){if(0===m(r)&&(e+=" "+"87654321"[d(r)]+" |"),null==t[r])e+=" . ";else{var n=t[r].type;e+=" "+(t[r].color===A?n.toUpperCase():n.toLowerCase())+" "}r+1&136&&(e+="|\n",r+=8)}return(e+="   +------------------------+\n")+"     a  b  c  d  e  f  g  h"},remove:function(e){return function(e){var n=G(e);return t[f[e]]=null,n&&n.type===_&&(r[n.color]=N),D(K()),n}(e)},perft:function(e){return ae(e)},square_color:function(e){if(e in f){var t=f[e];return(d(t)+m(t))%2==0?"light":"dark"}return null},history:function(e){for(var t=[],r=[],n=(void 0!==e&&"verbose"in e&&e.verbose);T.length>0;)t.push(re());for(;t.length>0;){var o=t.pop();n?r.push(oe(o)):r.push(W(o,H({legal:!0}))),te(o)}return r},get_comment:function(){return q[K()]},set_comment:function(e){q[K()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=q[K()];return delete q[K()],e},get_comments:function(){return R(),Object.keys(q).map((function(e){return{fen:e,comment:q[e]}}))},delete_comments:function(){return R(),Object.keys(q).map((function(e){var t=q[e];return delete q[e],{fen:e,comment:t}}))}}};var S=null,P="mg_values",x={minimaxRoot:function(e,t,r,n){var o=(S=new C(t)).moves(),a=-9999,i=null;P=n?"eg_values":"mg_values";for(var u=0;u<o.length;u++){var c=o[u];S.move(c);var l=this.minimax(e-1,S,-1e4,1e4,!r);S.undo(),l>=a&&(a=l,i=c)}return S.move(i,{sloppy:!0})},minimax:function(e,t,r,n,o){if(0===e)return-this.betterEvaluateBoard(t.board());var a=t.moves();if(o){for(var i=-9999,u=0;u<a.length;u++)if(t.move(a[u]),i=Math.max(i,this.minimax(e-1,t,r,n,!o)),t.undo(),n<=(r=Math.max(r,i)))return i;return i}for(var c=9999,l=0;l<a.length;l++)if(t.move(a[l]),c=Math.min(c,this.minimax(e-1,t,r,n,!o)),t.undo(),(n=Math.min(n,c))<=r)return c;return c},betterEvaluateBoard:function(){for(var e=0,r=0,n=0,o=0,a=0,i=0,u=0,c=0,l=0,s=0,f=0,p=0,h=0,v=0,d=0,m=0,g=0;g<8;g++)for(var b=0;b<8;b++)if(null!==S.board()[g][b]){var y=S.board()[g][b].type;"P"===(y="w"===S.board()[g][b].color?y.toUpperCase():y.toLowerCase())?(e++,f+=t.P[P][0][8*g+b]):"p"===y?(r++,f-=t.p[P][0][8*g+b]):"N"===y?(n++,p+=t.N[P][0][8*g+b]):"n"===y?(o++,p-=t.n[P][0][8*g+b]):"B"===y?(a++,h+=t.B[P][0][8*g+b]):"b"===y?(i++,h-=t.b[P][0][8*g+b]):"R"===y?(u++,v+=t.R[P][0][8*g+b]):"r"===y?(c++,v-=t.r[P][0][8*g+b]):"Q"===y?(l++,d+=t.Q[P][0][8*g+b]):"q"===y?(s++,d-=t.q[P][0][8*g+b]):"K"===y?m+=t.K[P][0][8*g+b]:"k"===y&&(m-=t.k[P][0][8*g+b])}var w=100*(e-r)+320*(n-o)+330*(a-i)+500*(u-c)+900*(l-s)+f+p+h+v+d+m;return"w"===S.turn()?w:-w}},O=[["a8","b8","c8","d8","e8","f8","g8","h8"],["a7","b7","c7","d7","e7","f7","g7","h7"],["a6","b6","c6","d6","e6","f6","g6","h6"],["a5","b5","c5","d5","e5","f5","g5","h5"],["a4","b4","c4","d4","e4","f4","g4","h4"],["a3","b3","c3","d3","e3","f3","g3","h3"],["a2","b2","c2","d2","e2","f2","g2","h2"],["a1","b1","c1","d1","e1","f1","g1","h1"]];function T(e){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}function I(){I=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof f?t:f,a=Object.create(o.prototype),i=new N(n||[]);return a._invoke=function(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=w(i,r);if(u){if(u===s)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===s)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,i),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var s={};function f(){}function p(){}function h(){}var v={};u(v,o,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(L([])));m&&m!==t&&r.call(m,o)&&(v=m);var g=h.prototype=f.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function n(o,a,i,u){var c=l(e[o],e,a);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==T(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,u)}))}u(c.arg)}var o;this._invoke=function(e,r){function a(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(a,a):a()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return s;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return s}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,s;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,s):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,s)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function L(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:_}}function _(){return{value:void 0,done:!0}}return p.prototype=h,u(g,"constructor",h),u(h,"constructor",p),p.displayName=u(h,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(y.prototype),u(y.prototype,a,(function(){return this})),e.AsyncIterator=y,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new y(c(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),u(g,i,"Generator"),u(g,o,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=L,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,s):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),s},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),s}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:L(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),s}},e}function q(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,o)}var j=function(){var e,t=(e=I().mark((function e(t){var r,n;return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://explorer.lichess.ovh/masters?fen=".concat(t),{method:"GET"});case 2:return r=e.sent,e.next=5,r.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){q(a,n,o,i,u,"next",e)}function u(e){q(a,n,o,i,u,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function B(){B=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof f?t:f,a=Object.create(o.prototype),i=new N(n||[]);return a._invoke=function(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=w(i,r);if(u){if(u===s)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===s)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,i),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var s={};function f(){}function p(){}function h(){}var v={};u(v,o,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(L([])));m&&m!==t&&r.call(m,o)&&(v=m);var g=h.prototype=f.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function n(o,a,i,u){var c=l(e[o],e,a);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==R(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,u)}))}u(c.arg)}var o;this._invoke=function(e,r){function a(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(a,a):a()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return s;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return s}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,s;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,s):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,s)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function L(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:_}}function _(){return{value:void 0,done:!0}}return p.prototype=h,u(g,"constructor",h),u(h,"constructor",p),p.displayName=u(h,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(y.prototype),u(y.prototype,a,(function(){return this})),e.AsyncIterator=y,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new y(c(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),u(g,i,"Generator"),u(g,o,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=L,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,s):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),s},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),s}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:L(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),s}},e}function M(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,o)}var U=function(){var e,t=(e=B().mark((function e(t){var r,n,o,a,i,u,c,l,s,f,p,h;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,n=0,o=null,e.next=5,j(t);case 5:if(0!==(a=e.sent).black){e.next=10;break}return e.abrupt("return",null);case 10:for(o=a.moves,i=0;i<o.length;i++)u=o[i].white+o[i].black+o[i].draws,(c=o[i].black/u)>n&&(n=c,r=o[i].uci);for(l=[],s=[],f=0;f<O.length;f++)for(p=0;p<O[f].length;p++)O[f][p]===r.slice(0,2)?l=[f,p]:O[f][p]===r.slice(2,5)&&(s=[f,p]);return h=[l,s],e.abrupt("return",h);case 17:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){M(a,n,o,i,u,"next",e)}function u(e){M(a,n,o,i,u,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Q(){Q=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var o=t&&t.prototype instanceof f?t:f,a=Object.create(o.prototype),i=new N(n||[]);return a._invoke=function(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=w(i,r);if(u){if(u===s)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===s)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,i),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var s={};function f(){}function p(){}function h(){}var v={};u(v,o,(function(){return this}));var d=Object.getPrototypeOf,m=d&&d(d(L([])));m&&m!==t&&r.call(m,o)&&(v=m);var g=h.prototype=f.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function n(o,a,i,u){var c=l(e[o],e,a);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==K(f)&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,u)}))}u(c.arg)}var o;this._invoke=function(e,r){function a(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(a,a):a()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return s;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return s}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,s;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,s):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,s)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function L(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:_}}function _(){return{value:void 0,done:!0}}return p.prototype=h,u(g,"constructor",h),u(h,"constructor",p),p.displayName=u(h,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,u(e,i,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},b(y.prototype),u(y.prototype,a,(function(){return this})),e.AsyncIterator=y,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new y(c(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(g),u(g,i,"Generator"),u(g,o,(function(){return this})),u(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=L,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,s):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),s},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),s}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:L(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),s}},e}function D(e,t,r,n,o,a,i){try{var u=e[a](i),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,o)}var G=function(){var e,t=(e=Q().mark((function e(t,r,n){var o,a,i;return Q().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t).then((function(e){if(null===e){if(null===(e=x.minimaxRoot(3,t,!0,r)))return void(n?setTimeout((function(){alert("Checkmate!")}),100):setTimeout((function(){alert("Stalemate!")}),100));i=e.to,a=e.from}else a=e[0],i=e[1];for(var u=0;u<O.length;u++)for(var c=0;c<O[u].length;c++)O[u][c]===a&&(a=[u,c]),O[u][c]===i&&(i=[u,c]);o=document.querySelector('[data-row="'.concat(a[0],'"][data-col="').concat(a[1],'"]'))}));case 2:return e.abrupt("return",[o,i]);case 3:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){D(a,n,o,i,u,"next",e)}function u(e){D(a,n,o,i,u,"throw",e)}i(void 0)}))});return function(e,r,n){return t.apply(this,arguments)}}();function F(e){return function(e){if(Array.isArray(e))return $(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return $(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var H=function(e,t,r){for(var n=[],o=0;o<8;o++)for(var a=0;a<8;a++){var i=t[o][a];(" "!==i&&i===(null==i?void 0:i.toUpperCase())&&"white"===e||" "!==i&&i===(null==i?void 0:i.toLowerCase())&&"black"===e)&&n.push([o,a])}for(var u=[],c=0;c<n.length;c++){for(var l=n[c],s=Number(l[0]),f=Number(l[1]),p=[],h=0;h<t.length;h++){p[h]=[];for(var v=0;v<t[h].length;v++)p[h][v]=t[h][v]}if(" "!==p[s][f]){var d=Ve(s,f,p);if(r){for(var m=[],g=function(r){var n=[];t.map((function(e,t){return n[t]=F(e)}));var o=d[r],a=[Number(s),Number(f)];n[o[0]][o[1]]=n[a[0]][a[1]],n[a[0]][a[1]]=" ",W(n,e)&&m.push(o)},b=0;b<d.length;b++)g(b);for(var y=0;y<m.length;y++)d.splice(d.indexOf(m[y]),1)}u.push([l,F(d)])}}return u},W=function(e,t){var r=[];"white"===t?(r=H("black",e,!1)).map((function(e){return e.splice(0,1)})):"black"===t&&(r=H("white",e,!1)).map((function(e){return e.splice(0,1)}));var n;n="white"===t?"K":"k";for(var o=[],a=0;a<8;a++)for(var i=0;i<8;i++)e[a][i]===n&&(o=[a,i]);for(var u=!1,c=0;c<r.length;c++)r.some((function(e){return e[0].some((function(e){return e[0]===o[0]&&e[1]===o[1]}))}))&&(u=!0);return!!u},Y=function(e){for(var t=e.split(" ")[0].split("/"),r=[],n=0;n<8;n++){r[n]=[];for(var o=t[n].split(""),a=0;a<o.length;a++)if(isNaN(Number(o[a])))r[n].push(o[a]);else for(var i=0;i<o[a];i++)r[n].push(" ")}return r},z=e.p+"3ffec474411d1a3c4276d019a68d7356.mp3",X=e.p+"d7e096a6996bd3e3ed1e07d44610599e.mp3",Z=e.p+"4338f39648ca229eb58ead50cec2914a.mp3";function J(e){return function(e){if(Array.isArray(e))return V(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?V(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ee=new Audio(z),te=new Audio(Z),re=new Audio(X),ne="mg_values",oe=1,ae={makeMove:function(e,t,r,n,o,a){var i=document.querySelector('[data-row="'.concat(t[0],'"][data-col="').concat(t[1],'"]')),u=r[t[0]][t[1]],c=document.querySelector('[data-row="'.concat(e[0],'"][data-col="').concat(e[1],'"]')),l=!1,s=o,f=a;if(" "!==r[e[0]][e[1]]&&(l=!0),Xe(e,t,r),"k"===u&&(s=!1,f=!1),l)te.play(),c.firstChild.remove();else{if("P"===u){var p=Number(i.getAttribute("data-row"));Number(c.getAttribute("data-row"))===p-2&&(n=!0)}else if("p"===u){var h=Number(i.getAttribute("data-row"));Number(c.getAttribute("data-row"))===h+2&&(n=!0)}n&&c.setAttribute("isDoubleMovePawn","true")}return"true"===i.getAttribute("isdoublemovepawn")&&i.removeAttribute("isdoublemovepawn"),"true"===i.getAttribute("enpassantcapture")&&i.removeAttribute("enpassantcapture"),ee.play(),c.setAttribute("data-type",i.getAttribute("data-type")),c.appendChild(i.firstChild),i.setAttribute("data-type"," "),oe++,[i,c,i.firstChild,n,s,f]},getPieceToMove:function(e,r){var n=this,o=-99999,a=null,i=null,u=[];ne=r?"eg_values":"mg_values";for(var c=document.querySelectorAll(".cell"),l=this.getActualBoard(),s=H("white",l,!0),f=function(r){var f=c[r],p=f.getAttribute("data-row"),h=f.getAttribute("data-col"),v=f.getAttribute("data-type");if(" "!==v&&"black"===f.firstChild.getAttribute("piece-color")){var d=[],m=f.firstChild,g=n.getActualBoard(),b=0,y=t[v][ne][1]+t[v][ne][0][8*Number(p)+Number(h)];s.map((function(e){var r=e[0][0],n=e[0][1],o=t[g[r][n]][ne][1]+t[g[r][n]][ne][0][8*Number(p)+Number(h)],a=[];if(e[1].some((function(e){return e[0]===Number(p)&&e[1]===Number(h)}))){for(var i=0,u=0,c=0;c<e[1].length;c++){var s=e[1][c];s[0]===Number(p)&&s[1]===Number(h)&&(i=s[0],u=s[1])}l.map((function(e,t){return a[t]=J(e)})),a[i][u]=a[r][n],a[r][n]=" ",H("black",a,!0).map((function(e){var r=e[0][0],n=e[0][1],i=t[a[r][n]][ne][0][8*Number(p)+Number(h)];b=e[1].some((function(e){return e[0]===Number(p)&&e[1]===Number(h)}))?o-y+i:y}))}})),d=Ve(p,h,g);for(var w=[],E=0;E<d.length;E++){var A=n.getActualBoard(),N=d[E],L=[Number(p),Number(h)];A[N[0]][N[1]]=A[L[0]][L[1]],A[L[0]][L[1]]=" ",W(A,"black")&&w.push(N)}for(var _=0;_<w.length;_++)d.splice(d.indexOf(w[_]),1);if(e&&re.play(),d.length>0){var k=n.getBestMove(d,[p,h]);(b+=k[1])>o?(a=k[0],i=m,o=b,(u=[]).push([a,m])):b===o&&(a=k[0],u.push([a,m]))}}},p=0;p<c.length;p++)f(p);if(u.length>0){var h=Math.floor(Math.random()*u.length);a=u[h][0],i=u[h][1]}return[i,a]},getBestMove:function(e,r){for(var n=null,o=-1,a=this.getActualBoard(),i=Number(r[0]),u=Number(r[1]),c=a[i][u],l=function(r){var l=e[r],s=a[l[0]][l[1]],f=[];a.map((function(e,t){return f[t]=J(e)})),f[l[0]][l[1]]=f[i][u],f[i][u]=" ";var p=H("white",f,!0),h=Math.min.apply(Math,J(p.map((function(e){var r=0,n=Number(l[0]),o=Number(l[1]),a=Number(e[0][0]),i=Number(e[0][1]),u=t[c][ne][1]+t[c][ne][0][8*n+o],p=0;if(" "!==s&&(p=t[s][ne][1]+t[s][ne][0][8*n+o]),e[1].some((function(e){return e[0]===n&&e[1]===o}))){for(var h=0,v=0,d=0;d<e[1].length;d++){var m=e[1][d];m[0]===n&&m[1]===o&&(h=m[0],v=m[1])}var g=[];f.map((function(e,t){return g[t]=J(e)})),g[h][v]=g[a][i],g[a][i]=" ";var b=H("black",g,!0);if(b.map((function(e){return e.splice(0,1)})),b.some((function(e){return e[0].some((function(e){return e[0]===n&&e[1]===o}))}))){var y=e[1].find((function(e){return e[0]===n&&e[1]===o})),w=g[y[0]][y[1]],E=0;" "!==w&&(E=t[w][ne][1]+t[w][ne][0][8*n+o]),r=p-u+E}else r=p-u}else r=t[c][ne][0][8*n+o]+p;return r}))));h>=(null===n?-1:o)&&(n=l,o=h)},s=0;s<e.length;s++)l(s);return null==n&&(n=e[Math.floor(Math.random()*e.length)],o=-1),[n,o]},evaluateBoard:function(e,r){var n=this.getNumberOfPieces("white","P"),o=this.getNumberOfPieces("white","N"),a=this.getNumberOfPieces("white","B"),i=this.getNumberOfPieces("white","R"),u=this.getNumberOfPieces("white","Q"),c=100*(n-this.getNumberOfPieces("black","p"))+320*(o-this.getNumberOfPieces("black","n"))+330*(a-this.getNumberOfPieces("black","b"))+500*(i-this.getNumberOfPieces("black","r"))+900*(u-this.getNumberOfPieces("black","q")),l=[];l=e.map((function(e,t){return l[t]=J(e)}));for(var s=0,f=0;f<8;f++)for(var p=0;p<8;p++)"P"===l[f][p]?s+=t.P[ne][0][8*f+p]:"p"===l[f][p]&&(s-=t.p[ne][0][8*f+p]);for(var h=0,v=0;v<8;v++)for(var d=0;d<8;d++)"N"===l[v][d]?h+=t.N[ne][0][8*v+d]:"n"===l[v][d]&&(h-=t.n[ne][0][8*v+d]);for(var m=0,g=0;g<8;g++)for(var b=0;b<8;b++)"B"===l[g][b]?m+=t.B[ne][0][8*g+b]:"b"===l[g][b]&&(m-=t.b[ne][0][8*g+b]);for(var y=0,w=0;w<8;w++)for(var E=0;E<8;E++)"R"===l[w][E]?y+=t.R[ne][0][8*w+E]:"r"===l[w][E]&&(y-=t.r[ne][0][8*w+E]);for(var A=0,N=0;N<8;N++)for(var L=0;L<8;L++)"Q"===l[N][L]?A+=t.Q[ne][0][8*N+L]:"q"===l[N][L]&&(A-=t.q[ne][0][8*N+L]);for(var _=0,k=0;k<8;k++)for(var C=0;C<8;C++)"K"===l[k][C]?_+=t.K[ne][0][8*k+C]:"k"===l[k][C]&&(_-=t.k[ne][0][8*k+C]);var S=c+s+h+m+y+A+_;return"white"===r?S:-S},getNumberOfPieces:function(e,t){for(var r=0,n=document.querySelectorAll(".cell"),o=0;o<n.length;o++){var a=n[o],i=a.getAttribute("data-type");" "!==i&&a.firstChild.getAttribute("piece-color")===e&&i===t&&r++}return r},getActualBoard:function(){for(var e=[],t=0;t<8;t++){e[t]=[];for(var r=0;r<8;r++){var n=document.querySelector('[data-row="'.concat(t,'"][data-col="').concat(r,'"]')).getAttribute("data-type");e[t][r]=" "!==n?n:" "}}return e},getFenFromBoard:function(e,t,r,n,o,a){for(var i="",u=0;u<8;u++){for(var c=0,l=0;l<8;l++)" "===e[u][l]?c++:(c>0&&(i+=c,c=0),i+=e[u][l]);c>0&&(i+=c),7!==u&&(i+="/")}var s="";return r&&(s+="K"),n&&(s+="Q"),o&&(s+="k"),a&&(s+="q"),""===s&&(s="-"),i+" b "+s+" - "+t+" "+oe}},ie=e.p+"d5902a1bf4e8e47585eeca0a3ef1aed0.mp3";function ue(e){return function(e){if(Array.isArray(e))return ce(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ce(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ce(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var le=document.querySelector(".primary-navigation"),se=document.querySelector(".mobile-nav-toggle");se.addEventListener("click",(function(){"false"===le.getAttribute("data-visible")?(le.setAttribute("data-visible","true"),se.setAttribute("aria-expanded","true")):(le.setAttribute("data-visible","false"),se.setAttribute("aria-expanded","false"))}));var fe="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w",pe=!1,he=null,ve=null,de=!0,me=!0,ge=!0,be=!0,ye=!1,we=!1,Ee="white",Ae=!1,Ne="PvsP",Le=null,_e=!1,ke=!1,Ce=null,Se=null,Pe=3e5,xe=3e5,Oe=0,Te=[],Ie=new Audio(z),qe=new Audio(ie),je=new Audio(Z),Re=new Audio(X);document.getElementById("play-button").addEventListener("click",(function(){Ke()}),!1),window.onload=function(){Ke()};var Be=document.getElementsByClassName("white-timer-text"),Me=document.getElementsByClassName("black-timer-text"),Ue=document.getElementById("timer-line"),Ke=function(){Qe(fe),Fe(Ce),Fe(Se),(Be=ue(Be)).map((function(e){return e.innerHTML="5:00"})),(Me=ue(Me)).map((function(e){return e.innerHTML="5:00"})),Ue.classList.add("timer-line"),Ee="w"===fe.split(" ")[1]?"white":"black";var e=document.getElementsByClassName("grid-container")[0];null!=e&&(e.innerHTML=""),Ne=Ye().value;var t="AI",r=document.getElementsByClassName("timers"),n=document.getElementsByClassName("mobile-timer");"PvsAI"===Ne?(t=ze().value,r[0].classList.add("disabled"),n[0].classList.add("disabled")):(ze().parentElement.innerHTML=" ",r[0].classList.remove("disabled"),n[0].classList.remove("disabled")),_e="Easy"!==t;var o=document.createElement("div");o.classList.add("grid"),e.appendChild(o);for(var a=Y(fe),i=0;i<8;i++){var u=document.createElement("div");u.classList.add("grid-row");for(var c=0;c<8;c++){var l=document.createElement("div"),s=a[i][c],f=(c+i)%2==0?"white":"black";l.classList.add("cell"),De(l,s,f),l.setAttribute("data-row",i),l.setAttribute("data-col",c),l.setAttribute("data-type",s),l.setAttribute("color",f),u.appendChild(l)}null!=o&&o.appendChild(u)}},Qe=function(e){me=!0,de=!0,be=!0,ge=!0;var t=Y(e);"R"!==t[7][0]&&(me=!1),"R"!==t[7][7]&&(de=!1),"r"!==t[0][0]&&(be=!1),"r"!==t[0][7]&&(ge=!1),pe=!1,he=null,ve=null,ye=!1,we=!1,Ee="white",Ae=!1,Le=null,ke=!1,Pe=3e5,xe=3e5},De=function(e,r){var n=document.createElement("img");" "!==r&&(r===r.toUpperCase()?(n.src=t["".concat(r)].image,n.addEventListener("click",$e),n.setAttribute("piece-color","white")):(n.src=t["".concat(r)].image,n.addEventListener("click",$e),n.setAttribute("piece-color","black")),e.appendChild(n))};function Ge(e,t,r){var n,o,a=Date.now();"white"===r?Ce=setInterval((function(){var r=Date.now()-a;Pe=e-r,n=Math.floor(Pe/6e4),0===(o=Math.floor(Pe%6e4/1e3))&&(0===n?(Fe(Ce),alert("Black wins!")):(n--,o=59)),o<10&&(o="0"+o),t.map((function(e){return e.innerHTML="".concat(n,":").concat(o)}))}),100):Se=setInterval((function(){var r=Date.now()-a;xe=e-r,n=Math.floor(xe/6e4),0===(o=Math.floor(xe%6e4/1e3))&&(0===n?(Fe(Se),alert("White wins!")):(n--,o=59)),o<10&&(o="0"+o),t.map((function(e){return e.innerHTML="".concat(n,":").concat(o)}))}),100)}function Fe(e){clearInterval(e)}var $e=function e(t){if(pe)if(he.getAttribute("piece-color")===t.target.getAttribute("piece-color"))nt();else{var n=[Number(t.target.parentElement.getAttribute("data-row")),Number(t.target.parentElement.getAttribute("data-col"))],o=Number(he.parentElement.getAttribute("data-row")),a=Number(he.parentElement.getAttribute("data-col")),i=r(),u=Ve(o,a,i);Te=ue(u);for(var c=[],l=0;l<u.length;l++){var s=r(),f=u[l],p=[Number(o),Number(a)];s[f[0]][f[1]]=s[p[0]][p[1]],s[p[0]][p[1]]=" ",W(s,"white")&&c.push(f)}for(var h=0;h<c.length;h++)u.splice(u.indexOf(c[h]),1);if(u.some((function(e){return e[0]===n[0]&&e[1]===n[1]}))){ye=!0,je.play(),nt();var v=he.cloneNode(!0),d=t.target.parentElement;if(v.addEventListener("click",e),t.target.parentElement.appendChild(v),t.target.parentElement.setAttribute("data-type",he.parentElement.getAttribute("data-type")),t.target.parentElement.removeChild(t.target),he.parentElement.setAttribute("data-type"," "),he.parentElement.removeChild(he),he=null,pe=!1,Je(t.target.parentElement,v.parentElement),"white"===Ee?(Fe(Ce),"PvsP"===Ne&&Ge(xe,Me,"black")):(Fe(Se),Ge(Pe,Be,"white")),Oe=0,Le=d.firstChild,rt(),"PvsAI"===Ne&&"black"===Ee){var m=null,g=null;if(_e){var b=r(),y=ae.getFenFromBoard(b,Oe,de,me,ge,be);G(y,ke,Ae).then((function(e){var t=e[1],r=e[0].firstChild;tt(r,t),rt()}))}else{i=r();var w=ae.getPieceToMove(Ae,ke);if(g=w[0],m=w[1],ve=g,null===g)return void et();tt(g,m),Ge(Pe,Be,"white"),rt()}}return}nt()}pe=!0,he=t.target;var E=t.target.parentElement,A=E.getAttribute("data-row"),N=E.getAttribute("data-col"),L=E.getAttribute("data-type");if((L===L.toUpperCase()?"white":"black")===Ee){var _=r();null!==Le&&(Number(Le.parentElement.getAttribute("data-row")),Number(Le.parentElement.getAttribute("data-col")));var k=[];k=Ve(A,N,_),Te=ue(k);for(var C=[],S=0;S<k.length;S++){var P=r(),x=k[S],O=[Number(A),Number(N)];P[x[0]][x[1]]=P[O[0]][O[1]],P[O[0]][O[1]]=" ",W(P,"white")&&C.push(x)}for(var T=0;T<C.length;T++)k.splice(k.indexOf(C[T]),1);if(0===k.length)return void et();if(null!=k&&k.length>0)for(var I=0;I<k.length;I++)if("PvsP"===Ne||"PvsAI"===Ne&&"white"===Ee){var q=document.getElementsByClassName("cell")[8*k[I][0]+k[I][1]];q.classList.add("highlight"),q.addEventListener("click",He)}Te=ue(k)}else Te=[]},He=function(e){Ie.play(),pe=!1,ye=!1,"PvsAI"===Ne&&"black"===Ee&&(he=ve),nt();var t=e.target,n=[t.getAttribute("data-row"),t.getAttribute("data-col")],o=[he.parentElement.getAttribute("data-row"),he.parentElement.getAttribute("data-col")],a=r();Xe(n,o,a);var i=he.parentElement.getAttribute("data-type"),u=o[0],c=o[1];("K"===i||"R"===i&&"7"===u&&"0"===c)&&(me=!1),("K"===i||"R"===i&&"7"===u&&"7"===c)&&(de=!1),("k"===i||"r"===i&&"0"===u&&"0"===c)&&(be=!1),("k"===i||"r"===i&&"0"===u&&"7"===c)&&(ge=!1),Oe++;var l=e.target;if("P"===he.parentElement.getAttribute("data-type")){Oe=0;var s=Number(he.parentElement.getAttribute("data-row"));Number(l.getAttribute("data-row"))===s-2&&(we=!0)}else if("p"===he.parentElement.getAttribute("data-type")){Oe=0;var f=Number(he.parentElement.getAttribute("data-row"));Number(l.getAttribute("data-row"))===f+2&&(we=!0)}var p=he.parentElement.cloneNode(!0),h=he.src,v=he.getAttribute("piece-color");l.setAttribute("data-type",he.parentElement.getAttribute("data-type")),we&&l.setAttribute("isDoubleMovePawn","true"),we=!1,he.parentElement.setAttribute("data-type"," "),"true"===he.parentElement.getAttribute("isdoublemovepawn")&&he.parentElement.removeAttribute("isdoublemovepawn"),"true"===he.parentElement.getAttribute("enpassantcapture")&&he.parentElement.removeAttribute("enpassantcapture"),he.parentElement.removeChild(he);var d=document.createElement("img");d.src=h,d.addEventListener("click",$e),d.setAttribute("piece-color",v),l.appendChild(d);var m=e.target;if(Je(m,p),Ze(m),"white"===Ee?(Fe(Ce),"PvsP"===Ne&&Ge(xe,Me,"black")):(Fe(Se),Ge(Pe,Be,"white")),Le=e.target.firstChild,rt(),"PvsAI"===Ne&&"black"===Ee)if(_e){var g=r(),b=ae.getFenFromBoard(g,Oe,de,me,ge,be);G(b,ke,Ae).then((function(e){var t=e[1],r=e[0].firstChild;tt(r,t),rt()}))}else{a=r();var y=ae.getPieceToMove(Ae,ke),w=y[0],E=y[1];if(ve=w,null===w)return void et();tt(w,E),rt()}},We=function(e,t,r){var n=r[Number(e[0])][Number(e[1])],o=n.toUpperCase()===n?"white":"black";if(t[0]>7||t[0]<0||t[1]>7||t[1]<0)return!1;var a=r[Number(t[0])][Number(t[1])],i=a===a.toUpperCase()?"white":"black";return" "===a||t===e||i!==o&&"P"!==n.toUpperCase()&&"capture"},Ye=function(){var e=document.getElementsByClassName("mode-selector")[0];if(e)return e;var t=document.createElement("select");t.classList.add("mode-selector");var r=document.createElement("label");r.innerHTML="Mode: ",r.id="mode-msg";var n=document.createElement("option");n.value="PvsP",n.selected=!0,n.innerHTML="PvsP";var o=document.createElement("option");o.value="PvsAI",o.innerHTML="PvsAI",t.appendChild(n),t.appendChild(o),t.addEventListener("change",Ke);var a=document.getElementsByClassName("mode")[0];return a.appendChild(r),a.appendChild(t),t},ze=function(){var e=document.getElementsByClassName("difficulty-selector")[0];if(e)return e;var t=document.createElement("select");t.classList.add("difficulty-selector");var r=document.createElement("label");r.innerHTML="Difficulty: ",r.id="diff-msg";var n=document.createElement("option");n.value="Easy",n.selected=!0,n.innerHTML="Easy";var o=document.createElement("option");o.value="Normal",o.innerHTML="Normal",t.appendChild(n),t.appendChild(o),t.addEventListener("change",Ke);var a=document.getElementsByClassName("difficulty")[0];return a.appendChild(r),a.appendChild(t),t},Xe=function(e,t,r){var n=r[Number(t[0])][Number(t[1])],o=Number(e[0]),a=Number(e[1]),i=r[o][a];if("K"===n&&" "===i){var u=null,c=null,l=null;me&&7===o&&2===a?(u=document.querySelector('[data-row="7"][data-col="0"]').firstChild,c=document.querySelector('[data-row="7"][data-col="3"]'),l=u.cloneNode(!0)):de&&7===o&&6===a&&(u=document.querySelector('[data-row="7"][data-col="7"]').firstChild,c=document.querySelector('[data-row="7"][data-col="5"]'),l=u.cloneNode(!0)),null!=u&&null!=c&&null!=l&&(l.addEventListener("click",$e),c.appendChild(l),c.setAttribute("data-type","R"),u.parentElement.setAttribute("data-type"," "),u.parentElement.removeChild(u),qe.play())}else if("k"===n&&" "===i){var s=null,f=null,p=null;ge&&0===o&&6===a?(s=document.querySelector('[data-row="0"][data-col="7"]').firstChild,f=document.querySelector('[data-row="0"][data-col="5"]'),p=s.cloneNode(!0)):be&&0===o&&2===a&&(s=document.querySelector('[data-row="0"][data-col="0"]').firstChild,f=document.querySelector('[data-row="0"][data-col="3"]'),p=s.cloneNode(!0)),null!=s&&null!=f&&null!=p&&(p.addEventListener("click",$e),f.appendChild(p),f.setAttribute("data-type","r"),s.parentElement.setAttribute("data-type"," "),s.parentElement.removeChild(s),qe.play())}},Ze=function(e){var t=Number(e.getAttribute("data-row")),r=Number(e.getAttribute("data-col"));if("true"===(null==e?void 0:e.getAttribute("enpassantcapture"))&&"P"===(null==e?void 0:e.getAttribute("data-type"))){je.play();var n=document.querySelector('[data-row="'.concat(t+1,'"][data-col="').concat(r,'"]'));n.removeChild(n.firstChild)}if("true"===(null==e?void 0:e.getAttribute("enpassantcapture"))&&"p"===(null==e?void 0:e.getAttribute("data-type"))){je.play();var o=document.querySelector('[data-row="'.concat(t-1,'"][data-col="').concat(r,'"]'));o.removeChild(o.firstChild)}},Je=function(e,r){var n=ye?r:e.cloneNode(!0),o=ye?r:e,a=Number(ye?r.getAttribute("data-row"):e.getAttribute("data-row"));if("P"===(null==n?void 0:n.getAttribute("data-type"))&&0===a){o.removeChild(o.firstChild);var i=document.createElement("img");i.src=t.Q.image,i.setAttribute("piece-color","white"),i.addEventListener("click",$e),o.setAttribute("data-type","Q"),o.appendChild(i)}else if("p"===(null==o?void 0:o.getAttribute("data-type"))&&7===a){o.removeChild(o.firstChild);var u=document.createElement("img");u.src=t.q.image,u.setAttribute("piece-color","black"),u.addEventListener("click",$e),o.setAttribute("data-type","q"),o.appendChild(u)}},Ve=function(e,r,n){var o=[],a=n[Number(e)][Number(r)],i=t[a].moves;if(me&&"K"===a&&"7"===e&&"4"===r){var u=n[7][1],c=n[7][2],l=n[7][3];" "===u&&" "===c&&" "===l&&o.push([7,2])}if(de&&"K"===a&&"7"===e&&"4"===r){var s=n[7][5],f=n[7][6];" "===s&&" "===f&&o.push([7,6])}if(be&&"k"===a&&"0"===e&&"4"===r){var p=n[0][1],h=n[0][2],v=n[0][3];" "===p&&" "===h&&" "===v&&o.push([0,2])}if(ge&&"k"===a&&"0"===e&&"4"===r){var d=n[0][5],m=n[0][6];" "===d&&" "===m&&o.push([0,6])}if("P"===a.toUpperCase()){var g=[Number(e),Number(r)],b=function(e,t){var r=Number(e[0]),n=Number(e[1]),o=[];if("P"===t[r][n]){if(r-1<0||n+1>7||n-1<0)return!1;var a=t[r-1][n+1],i=t[r-1][n-1],u=document.querySelector('[data-row="'.concat(r,'"][data-col="').concat(n+1,'"]')),c=document.querySelector('[data-row="'.concat(r,'"][data-col="').concat(n-1,'"]'));if(" "!==a&&a===(null==a?void 0:a.toLowerCase())&&o.push([r-1,n+1])," "!==i&&i===(null==i?void 0:i.toLowerCase())&&o.push([r-1,n-1]),"true"===(null==u?void 0:u.getAttribute("isdoublemovepawn"))&&"p"===(null==u?void 0:u.getAttribute("data-type"))){var l=document.querySelector('[data-row="'.concat(r-1,'"][data-col="').concat(n+1,'"]'));l.setAttribute("enpassantcapture","true"),Te.push(l)}if("true"===(null==c?void 0:c.getAttribute("isdoublemovepawn"))&&"p"===(null==c?void 0:c.getAttribute("data-type"))){var s=document.querySelector('[data-row="'.concat(r-1,'"][data-col="').concat(n-1,'"]'));s.setAttribute("enpassantcapture","true"),Te.push(s)}}else if("p"===t[r][n]){if(r+1>7||n+1>7||n-1<0)return!1;var f=t[r+1][n+1],p=t[r+1][n-1],h=document.querySelector('[data-row="'.concat(r,'"][data-col="').concat(n+1,'"]')),v=document.querySelector('[data-row="'.concat(r,'"][data-col="').concat(n-1,'"]'));if(" "!==f&&f===(null==f?void 0:f.toUpperCase())&&o.push([r+1,n+1])," "!==p&&p===(null==p?void 0:p.toUpperCase())&&o.push([r+1,n-1]),"true"===(null==h?void 0:h.getAttribute("isdoublemovepawn"))&&"P"===(null==h?void 0:h.getAttribute("data-type"))){var d=document.querySelector('[data-row="'.concat(r+1,'"][data-col="').concat(n+1,'"]'));d.setAttribute("enpassantcapture","true"),Te.push(d)}if("true"===(null==v?void 0:v.getAttribute("isdoublemovepawn"))&&"P"===(null==v?void 0:v.getAttribute("data-type"))){var m=document.querySelector('[data-row="'.concat(r+1,'"][data-col="').concat(n-1,'"]'));m.setAttribute("enpassantcapture","true"),Te.push(m)}}return o.length>0&&o}(g,n);if(!1!==b)for(var y=0;y<b.length;y++)o.push(b[y]);(function(e,t){if("P"===t[e[0]][e[1]].toUpperCase()){var r=e[0],n=e[1],o=t[r][n]===t[r][n].toLowerCase()?"black":"white";if("black"===o&&1!==r)return;if("white"===o&&6!==r)return;var a="black"===o?t[r+2][n]:t[r-2][n],i=" "!==t[r-1][n],u=" "!==t[r+1][n];return"P"===t[r][n]&&" "===a&&!i||"p"===t[r][n]&&" "===a&&!u}return!1})(g,n)&&("p"===a?o.push([Number(e)+2,Number(r)]):o.push([Number(e)-2,Number(r)]))}for(var w=0;w<i.length;w++){var E=[],A=[];if("P"===a.toUpperCase()||"N"===a.toUpperCase()||"K"===a.toUpperCase())E.push(Number(e)+i[w][0]),A.push(Number(r)+i[w][1]);else for(var N=0;N<7;N++)i[w][0]>0?E.push(Number(e)+i[w][0]+N):i[w][0]<0?E.push(Number(e)+i[w][0]-N):0===i[w][0]&&E.push(Number(e)),i[w][1]>0?A.push(Number(r)+i[w][1]+N):i[w][1]<0?A.push(Number(r)+i[w][1]-N):0===i[w][1]&&A.push(Number(r));for(var L=[],_=0;_<E.length;_++){if(L=[E[_],A[_]],!1===We([Number(e),Number(r)],L,n)){E.splice(_,E.length-_),A.splice(_,A.length-_);break}"capture"===We([Number(e),Number(r)],L,n)&&E.splice(_+1,E.length-_)}if(E.length>0)for(var k=0;k<E.length;k++){L=[E[k],A[k]];var C=n[E[k]][A[k]],S=C.toUpperCase()===C?"white":"black",P=a.toUpperCase()===a?"white":"black";(" "===C||S!==P)&&o.push(L)}}return Te=[].concat(o),o},et=function(){Ae?setTimeout((function(){alert("Checkmate!")}),100):setTimeout((function(){alert("Stalemate!")}),100)},tt=function(e,t){var n=r();"P"===e.parentElement.getAttribute("data-type").toUpperCase()||" "!==n[t[0]][t[1]]?Oe=0:Oe++;var o=[Number(e.parentElement.getAttribute("data-row")),Number(e.parentElement.getAttribute("data-col"))],a=ae.makeMove(t,o,n,we,ge,be),i=[100*ae.getNumberOfPieces("white","P")+300*ae.getNumberOfPieces("white","N")+330*ae.getNumberOfPieces("white","B")+500*ae.getNumberOfPieces("white","R")+900*ae.getNumberOfPieces("white","Q"),100*ae.getNumberOfPieces("black","p")+300*ae.getNumberOfPieces("black","n")+330*ae.getNumberOfPieces("black","b")+500*ae.getNumberOfPieces("black","r")+900*ae.getNumberOfPieces("black","q")];i[0]<1400&&i[1]<1400&&(ke=!0);var u=a[0],c=a[1];Le=a[2],we=a[3],ge=a[4],be=a[5],Je(c,u),Ze(c),n=r(),0!==H("white",n,!0).length||et()},rt=function(){var e=r();Ee="white"===Ee?"black":"white",function(){for(var e=document.getElementsByClassName("grid-container")[0].getElementsByClassName("grid-row"),t="",r=0;r<8;r++){for(var n="",o=0,a=e[r].getElementsByClassName("cell"),i=0;i<8;i++){var u=a[i];" "===u.getAttribute("data-type")?o++:(0!=o&&(n+=String(o),o=0),n+=u.getAttribute("data-type"))}0!=o&&(n+=String(o)),t+=n+"/"}t=t.slice(0,-1),Ee[0]}(),(Ae=W(e,"white"))&&Re.play()},nt=function(){for(var e=0;e<8;e++)for(var t=0;t<8;t++){var r=document.getElementsByClassName("cell")[8*e+t];r.classList.remove("highlight"),r.removeEventListener("click",He)}}}();
//# sourceMappingURL=main.js.map